<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Pro Account</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

Â  <main class="max-w-4xl mx-auto px-4 py-8">
Â  Â  <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4 text-blue-700">ðŸ’Ž Pro Account Status</h2>
Â  Â  Â  <p><strong>Active:</strong> <span id="isProStatus">Loading...</span></p>
Â  Â  Â  <p><strong>Expires On:</strong> <span id="proExpiryDate">-</span></p>

Â  Â  Â  <hr class="my-4" />

Â  Â  Â  <h3 class="text-lg font-semibold text-blue-600 mb-2">Pro Account Plan</h3>
Â  Â  Â  <ul class="list-disc list-inside space-y-1 text-gray-700 mb-6">
Â  Â  Â  Â  <li>Activation Cost: à§³<span id="proActivationCost">...</span></li>
Â  Â  Â  Â  <li>Daily Bonus: à§³<span id="proDailyBonus">...</span></li>
Â  Â  Â  Â  <li>Validity: <span id="proValidity">...</span> days</li>
Â  Â  Â  </ul>

Â  Â  Â  <button
Â  Â  Â  Â  id="activateProBtn"
Â  Â  Â  Â  class="bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed"
Â  Â  Â  >
Â  Â  Â  Â  Activate Pro Account
Â  Â  Â  </button>

Â  Â  Â  <!-- Claim Bonus Component Container -->
Â  Â  Â  <div id="dailyBonusContainer" class="mt-6"></div>
Â  Â  </div>
Â  </main>

Â  <!-- Firebase Pro Logic -->
Â  <script type="module">
Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
Â  Â  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
Â  Â  import { getFirestore, doc, getDoc, updateDoc, Timestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
Â  Â  import { renderDailyBonusButton } from "./dailyBonus.js";

Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyCkYWvYNsg2-CR88Js6gcP2nXfvwI4TW30",
Â  Â  Â  authDomain: "bdwork-346d3.firebaseapp.com",
Â  Â  Â  projectId: "bdwork-346d3",
Â  Â  Â  storageBucket: "bdwork-346d3.appspot.com",
Â  Â  Â  messagingSenderId: "900963179093",
Â  Â  Â  appId: "1:900963179093:web:81e42d67bb31d603cc92dc",
Â  Â  Â  measurementId: "G-FM1YJ8E5GK"
Â  Â  };

Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const auth = getAuth(app);
Â  Â  const db = getFirestore(app);

Â  Â  let currentUserData = null;
Â  Â  let proSettings = null;

Â  Â  onAuthStateChanged(auth, async (user) => {
Â  Â  Â  if (!user) return window.location.href = "login.html";

Â  Â  Â  const userRef = doc(db, "users", user.uid);
Â  Â  Â  const userSnap = await getDoc(userRef);
Â  Â  Â  currentUserData = { uid: user.uid, ...userSnap.data() };

Â  Â  Â  const settingsSnap = await getDoc(doc(db, "settings", "proAccount"));
Â  Â  Â  proSettings = settingsSnap.data();

Â  Â  Â  document.getElementById("proActivationCost").innerText = proSettings.activationCost ?? "-";
Â  Â  Â  document.getElementById("proDailyBonus").innerText = proSettings.dailyBonus ?? "-";
Â  Â  Â  document.getElementById("proValidity").innerText = proSettings.validity ?? "-";

Â  Â  Â  const now = new Date();
Â  Â  Â  let isPro = false;
Â  Â  Â  if (currentUserData.isPro && currentUserData.proExpiryTimestamp) {
Â  Â  Â  Â  const expiry = currentUserData.proExpiryTimestamp.toDate?.() ?? new Date(currentUserData.proExpiryTimestamp);
Â  Â  Â  Â  if (expiry > now) {
Â  Â  Â  Â  Â  isPro = true;
Â  Â  Â  Â  Â  document.getElementById("proExpiryDate").innerText = expiry.toLocaleDateString();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  await updateDoc(userRef, { isPro: false, proExpiryTimestamp: null });
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  document.getElementById("isProStatus").innerText = isPro ? "Yes" : "No";
Â  Â  Â  const btn = document.getElementById("activateProBtn");
Â  Â  Â  btn.disabled = isPro;
Â  Â  Â  btn.innerText = isPro ? "Pro Account Active" : "Activate Pro Account";

Â  Â  Â  btn.onclick = async () => {
Â  Â  Â  Â  const balance = currentUserData.balance || 0;
Â  Â  Â  Â  const cost = proSettings.activationCost;
Â  Â  Â  Â  const validity = proSettings.validity;

Â  Â  Â  Â  if (balance < cost) return alert(`Insufficient balance. Need à§³${cost}`);

Â  Â  Â  Â  const expiry = new Date(now.getTime() + validity * 24 * 60 * 60 * 1000);
Â  Â  Â  Â  await updateDoc(userRef, {
Â  Â  Â  Â  Â  isPro: true,
Â  Â  Â  Â  Â  balance: balance - cost,
Â  Â  Â  Â  Â  proExpiryTimestamp: Timestamp.fromDate(expiry)
Â  Â  Â  Â  });

Â  Â  Â  Â  alert("Pro Account Activated! Now claim your daily bonus.");
Â  Â  Â  Â  location.reload();
Â  Â  Â  };

Â  Â  Â  // Render claim bonus button
Â  Â  Â  renderDailyBonusButton("dailyBonusContainer");
Â  Â  });
Â  </script>
</body>
</html>
