<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>User Dashboard</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

Â  <main class="max-w-5xl mx-auto px-4 py-8">
Â  Â  <h1 class="text-3xl font-bold text-center mb-10">ðŸ‘‹ Welcome to Your Dashboard</h1>

Â  Â  <!-- User Info Section -->
Â  Â  <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
Â  Â  Â  <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100">
Â  Â  Â  Â  <p class="text-sm text-gray-500 mb-1">Email</p>
Â  Â  Â  Â  <p id="userEmail" class="text-lg sm:text-xl font-semibold text-gray-800 break-all">Loading...</p>

Â  Â  Â  Â  <p class="text-sm text-gray-500 mt-6 mb-1">Balance</p>
Â  Â  Â  Â  <p id="userBalance" class="text-lg sm:text-xl font-bold text-green-600">à§³0</p>
Â  Â  Â  </div>

Â  Â  Â  <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 flex items-center justify-center text-center">
Â  Â  Â  Â  <p id="accountStatus" class="text-lg sm:text-xl font-semibold text-gray-700">ðŸ”†</p>
Â  Â  Â  </div>

Â  Â  Â  <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100">
Â  Â  Â  Â  <p class="text-sm text-gray-500 mb-1">Total Refers</p>
Â  Â  Â  Â  <p id="totalRefers" class="text-lg sm:text-xl font-semibold text-gray-800">0</p>

Â  Â  Â  Â  <p class="text-sm text-gray-500 mt-6 mb-2">Your Refer Code</p>
Â  Â  Â  Â  <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
Â  Â  Â  Â  Â  <input id="userReferCode" readonly class="text-base sm:text-lg font-mono font-semibold text-blue-800 bg-blue-50 px-3 py-2 rounded w-full border border-blue-200" />
Â  Â  Â  Â  Â  <button onclick="copyReferCode()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 text-sm transition w-full sm:w-auto">
Â  Â  Â  Â  Â  Â  Copy
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <!-- Task Section -->
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4">ðŸŽ¯ Complete Tasks & Earn à§³5 Each</h2>
Â  Â  Â  <a href="job.html" class="block w-full text-center bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg transition">
Â  Â  Â  Â  Go to Tasks Page â†’
Â  Â  Â  </a>
Â  Â  </section>

Â  Â  <!-- Pro Account Section -->
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <a href="pro-account.html" class="block w-full text-center bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg transition">
Â  Â  Â  Â  Go to Pro Account Page â†’
Â  Â  Â  </a>
Â  Â  </section>

Â  Â  <!-- Deposit Form Section -->
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4">ðŸ’° Deposit Balance Funds</h2>
Â  Â  Â  <form id="depositForm" class="space-y-4">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label for="depositMethod" class="block text-sm font-medium text-gray-600 mb-1">Select Method</label>
Â  Â  Â  Â  Â  <select id="depositMethod" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-gray-700">
Â  Â  Â  Â  Â  Â  <option value="bKash">bKash</option>
Â  Â  Â  Â  Â  Â  <option value="Nagad">Nagad</option>
Â  Â  Â  Â  Â  Â  <option value="USDT">USDT</option>
Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label for="depositAmount" class="block text-sm font-medium text-gray-600 mb-1">Amount</label>
Â  Â  Â  Â  Â  <input type="number" id="depositAmount" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Enter amount..." min="0" required>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label for="paymentAddress" class="block text-sm font-medium text-gray-600 mb-1">Payment Address / Sender Number</label>
Â  Â  Â  Â  Â  <input type="text" id="paymentAddress" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Enter your payment address..." required>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition">
Â  Â  Â  Â  Â  Submit Deposit Request
Â  Â  Â  Â  </button>
Â  Â  Â  </form>
Â  Â  </section>

Â  Â  <!-- Deposit History Section -->
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4">ðŸ“¥ Deposit History</h2>
Â  Â  Â  <div id="depositHistory" class="space-y-2 text-sm text-gray-700">
Â  Â  Â  Â  <p>Loading deposit history...</p>
Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <!-- Withdraw Sections -->
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4">ðŸ’¸ Withdraw Balance</h2>
Â  Â  Â  <a href="withdraw.html" class="text-indigo-600 hover:underline text-center block">Go to Withdraw Page â†’</a>
Â  Â  </section>

Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 mb-8">
Â  Â  Â  <h2 class="text-xl font-semibold mb-4">ðŸ“œ Withdraw History</h2>
Â  Â  Â  <a href="withdraw-history.html" class="text-blue-600 hover:underline text-center block">View Withdraw History â†’</a>
Â  Â  </section>

Â  Â  <div class="text-center mt-8">
Â  Â  Â  <button onclick="logout()" class="bg-red-600 text-white px-6 py-2 rounded-md hover:bg-red-700 transition text-lg">
Â  Â  Â  Â  <i class="fas fa-sign-out-alt mr-2"></i> Logout
Â  Â  Â  </button>
Â  Â  </div>
Â  </main>

Â  <!-- Firebase & JS -->
Â  <script type="module">
Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyCkYWvYNsg2-CR88Js6gcP2nXfvwI4TW30",
Â  Â  Â  authDomain: "bdwork-346d3.firebaseapp.com",
Â  Â  Â  projectId: "bdwork-346d3",
Â  Â  Â  storageBucket: "bdwork-346d3.appspot.com",
Â  Â  Â  messagingSenderId: "900963179093",
Â  Â  Â  appId: "1:900963179093:web:81e42d67bb31d603cc92dc",
Â  Â  Â  measurementId: "G-FM1YJ8E5GK"
Â  Â  };

Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
Â  Â  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
Â  Â  import {
Â  Â  Â  getFirestore, doc, getDoc, collection, query, where, getDocs, addDoc, Timestamp, orderBy
Â  Â  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const auth = getAuth(app);
Â  Â  const db = getFirestore(app);
Â  Â  let currentUserData = null;

Â  Â  onAuthStateChanged(auth, async (user) => {
Â  Â  Â  if (!user) return window.location.href = "login.html";
Â  Â  Â  try {
Â  Â  Â  Â  const userDoc = await getDoc(doc(db, "users", user.uid));
Â  Â  Â  Â  if (userDoc.exists()) {
Â  Â  Â  Â  Â  currentUserData = { uid: user.uid, ...userDoc.data() };
Â  Â  Â  Â  Â  document.getElementById("userEmail").innerText = currentUserData.email;
Â  Â  Â  Â  Â  document.getElementById("userBalance").innerText = `à§³${currentUserData.balance || 0}`;
Â  Â  Â  Â  Â  document.getElementById("userReferCode").value = currentUserData.uid;
Â  Â  Â  Â  Â  document.getElementById("accountStatus").innerText = currentUserData.isPro ? "ðŸŒŸ Pro Account" : "ðŸ”† Regular Account";

Â  Â  Â  Â  Â  const referQuery = query(collection(db, "users"), where("referredBy", "==", user.uid));
Â  Â  Â  Â  Â  const referSnap = await getDocs(referQuery);
Â  Â  Â  Â  Â  document.getElementById("totalRefers").innerText = referSnap.size;

Â  Â  Â  Â  Â  loadDepositHistory(user.uid);
Â  Â  Â  Â  }
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  alert("Error loading user data: " + err.message);
Â  Â  Â  }
Â  Â  });

Â  Â  async function loadDepositHistory(uid) {
Â  Â  Â  const historyContainer = document.getElementById("depositHistory");
Â  Â  Â  historyContainer.innerHTML = "";

Â  Â  Â  const depositQuery = query(
Â  Â  Â  Â  collection(db, "deposits"),
Â  Â  Â  Â  where("uid", "==", uid),
Â  Â  Â  Â  orderBy("timestamp", "desc")
Â  Â  Â  );

Â  Â  Â  const snapshot = await getDocs(depositQuery);
Â  Â  Â  if (snapshot.empty) {
Â  Â  Â  Â  historyContainer.innerHTML = "<p>No deposit history found.</p>";
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  snapshot.forEach(doc => {
Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  const time = data.timestamp.toDate().toLocaleString();
Â  Â  Â  Â  const entry = document.createElement("div");
Â  Â  Â  Â  entry.className = "border p-3 rounded-lg bg-gray-50";
Â  Â  Â  Â  entry.innerHTML = `
Â  Â  Â  Â  Â  <strong>à§³${data.amount}</strong> via <strong>${data.method}</strong><br>
Â  Â  Â  Â  Â  <span class="text-xs text-gray-500">${time}</span><br>
Â  Â  Â  Â  Â  <span class="text-sm font-medium">Status: ${data.status}</span>
Â  Â  Â  Â  `;
Â  Â  Â  Â  historyContainer.appendChild(entry);
Â  Â  Â  });
Â  Â  }

Â  Â  window.logout = () => signOut(auth).then(() => window.location.href = "login.html");
Â  Â  window.copyReferCode = () => {
Â  Â  Â  const input = document.getElementById("userReferCode");
Â  Â  Â  input.select();
Â  Â  Â  input.setSelectionRange(0, 99999);
Â  Â  Â  navigator.clipboard.writeText(input.value).then(() => alert("Refer code copied!"));
Â  Â  };

Â  Â  document.getElementById("depositForm").addEventListener("submit", async function (e) {
Â  Â  Â  e.preventDefault();
Â  Â  Â  const method = document.getElementById("depositMethod").value;
Â  Â  Â  const amount = parseFloat(document.getElementById("depositAmount").value);
Â  Â  Â  const address = document.getElementById("paymentAddress").value.trim();

Â  Â  Â  if (!method || isNaN(amount) || amount <= 0 || !address) {
Â  Â  Â  Â  return alert("Please enter valid deposit details.");
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  await addDoc(collection(db, "deposits"), {
Â  Â  Â  Â  Â  uid: currentUserData.uid,
Â  Â  Â  Â  Â  userId: currentUserData.uid,
Â  Â  Â  Â  Â  userEmail: currentUserData.email,
Â  Â  Â  Â  Â  amount,
Â  Â  Â  Â  Â  method,
Â  Â  Â  Â  Â  address,
Â  Â  Â  Â  Â  timestamp: Timestamp.now(),
Â  Â  Â  Â  Â  status: "pending"
Â  Â  Â  Â  });
Â  Â  Â  Â  alert("Deposit request submitted!");
Â  Â  Â  Â  document.getElementById("depositForm").reset();
Â  Â  Â  Â  loadDepositHistory(currentUserData.uid);
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  alert("Error: " + err.message);
Â  Â  Â  }
Â  Â  });
Â  </script>
</body>
</html>
